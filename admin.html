<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Admin Panel</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
  <script src="firebase-config.js"></script>
  <style>
    body { background:#0d1117; color:#fff; font-family:Arial, sans-serif; margin:0; padding:20px; }
    h2 { margin-bottom:10px; }
    .panel { background:#161b22; padding:15px; border-radius:8px; margin-bottom:20px; }
    label { display:block; margin-top:10px; }
    input, select, button { width:100%; padding:8px; margin-top:5px; border-radius:5px; border:none; }
    button { background:#2ea043; color:white; font-weight:bold; cursor:pointer; }
    button:hover { background:#3fb950; }
    .logout { background:#f85149; }
  </style>
</head>
<body>
  <h1>Admin Panel</h1>
  <button class="logout" onclick="logout()">Logout</button>

  <div class="panel">
    <h2>Kelola Deposit</h2>
    <label>User ID:</label>
    <input type="text" id="depositUser">
    <label>Jumlah:</label>
    <input type="number" id="depositAmount">
    <button onclick="setDeposit()">Update Deposit</button>
  </div>

  <div class="panel">
    <h2>Kelola Withdraw</h2>
    <label>User ID:</label>
    <input type="text" id="withdrawUser">
    <label>Jumlah:</label>
    <input type="number" id="withdrawAmount">
    <button onclick="setWithdraw()">Proses Withdraw</button>
  </div>

  <div class="panel">
    <h2>Kelola Rekening</h2>
    <label>User ID:</label>
    <input type="text" id="bankUser">
    <label>Nomor Rekening:</label>
    <input type="text" id="bankAccount">
    <button onclick="setBank()">Update Rekening</button>
  </div>

  <script>
    const adminEmails = ["admin@gmail.com"]; // daftar admin yang diizinkan

    firebase.auth().onAuthStateChanged(user => {
      if (user) {
        if (!adminEmails.includes(user.email)) {
          alert("Akses ditolak, kamu bukan admin!");
          firebase.auth().signOut();
          window.location.href = "index.html";
        }
      } else {
        window.location.href = "index.html";
      }
    });

    function logout() {
      firebase.auth().signOut().then(() => {
        window.location.href = "index.html";
      });
    }

    function setDeposit() {
      let user = document.getElementById("depositUser").value;
      let amount = document.getElementById("depositAmount").value;
      firebase.database().ref("users/" + user + "/deposit").set(amount);
      alert("Deposit berhasil diupdate");
    }

    function setWithdraw() {
      let user = document.getElementById("withdrawUser").value;
      let amount = document.getElementById("withdrawAmount").value;
      firebase.database().ref("users/" + user + "/withdraw").set(amount);
      alert("Withdraw berhasil diproses");
    }

    function setBank() {
      let user = document.getElementById("bankUser").value;
      let account = document.getElementById("bankAccount").value;
      firebase.database().ref("users/" + user + "/bank").set(account);
      alert("Data rekening berhasil diupdate");
    }
  </script>
</body>
</html>
